<h1 class="text-3xl">{{.Chat.Name}}</h1>

<div>
    <details class="collapse bg-base-200">
        <summary class="collapse-title text-xl font-medium">
            <h3>View/hide chat members</h3>
        </summary>
        <div class="collapse-content">
            <div class="overflow-x-auto">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Avatar</th>
                            <th>Name</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Chat.Members}}
                        <tr>
                            <td>
                                <div class="avatar">
                                    <div class="mask mask-squircle w-12 h-12">
                                        <img src="{{.AvatarURL}}"
                                             alt="Avatar URL" />
                                    </div>
                                </div>
                            </td>
                            <td>
                                <div class="flex items-center space-x-3">
                                    <div>
                                        <div class="font-bold">{{.Name}}</div>
                                        <div class="text-sm opacity-50">{{.Email}}</div>
                                    </div>
                                </div>
                            </td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </div>
        </div>
    </details>
</div>

<!-- TODO: implement messages UI -->
{{if .Chat.Messages}}
<table>
    {{range .Chat.Messages}}
    <tr>
        <td>{{.From.Name}}</td>
        <td>{{.Content}}</td>
    </tr>
    {{end}}
</table>
{{else}}
<h6>chat is empty</h6>
{{end}}


<script>
    function sendMessage() {
        let message = document.getElementById("message").value
        console.log("message=", message)
        alert(message)

        $.post("/api/chat/{{.Chat.ID}}", {
            fromID: "{{.User.ID}}",
            content: message,
        })
    }
</script>

<form action=""
      method="POST">
    <input type="text"
           id="message"
           name="message"
           placeholder="write..."
           required />
    <input type="button"
           value="Send"
           onclick="sendMessage()" />
</form>